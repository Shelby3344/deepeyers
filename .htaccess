# ============================================
# ROOT SECURITY - BLOCK ALL SENSITIVE FILES
# ============================================

<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # Redirect everything to public folder
    RewriteCond %{REQUEST_URI} !^/public/
    RewriteRule ^(.*)$ public/$1 [L]
</IfModule>

# Block ALL access to root directory files
<FilesMatch ".*">
    Order allow,deny
    Deny from all
</FilesMatch>

# Block .env specifically (multiple layers)
<Files ".env">
    Order allow,deny
    Deny from all
</Files>

<Files ".env.example">
    Order allow,deny
    Deny from all
</Files>

<Files ".env.backup">
    Order allow,deny
    Deny from all
</Files>

# Block artisan
<Files "artisan">
    Order allow,deny
    Deny from all
</Files>

# Block composer files
<Files "composer.json">
    Order allow,deny
    Deny from all
</Files>

<Files "composer.lock">
    Order allow,deny
    Deny from all
</Files>

# Block all config files
<FilesMatch "\.(env|ini|log|yml|yaml|xml|json|lock|md|txt|sql|sqlite)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Block hidden files and directories
<FilesMatch "^\.">
    Order allow,deny
    Deny from all
</FilesMatch>

# Disable directory listing
Options -Indexes
